<!DOCTYPE html>
<html lang="vi" data-theme="PL">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="AimondNews — Tin tức & số liệu bóng đá Premier League và UEFA Champions League 2025/26">
  <title>{% block title %}AimondNews{% endblock %} — PL</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  {% block extra_css %}{% endblock %}

  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/logo.png') }}">
</head>
<body>

<header class="site-header" role="banner">
  <div class="container header-inner">

    <a href="/" class="header-logo" aria-label="AimondNews Home">
      <div class="header-logo-mark" style="background:transparent; padding:0;">
        <img src="/static/images/logo.png" alt="AimondNews Logo" style="width:100%; height:100%; object-fit:contain;" onerror="this.src='/static/images/logo.svg'">
      </div>
      <span class="header-logo-text">Aimond<span>News</span></span>
    </a>

    <nav class="header-nav" role="navigation" aria-label="Main navigation">
      <ul class="header-nav-list">
        <li><a href="/"           {% if request.path == '/' %}class="active"{% endif %}>Home</a></li>
        <li><a href="/news"       {% if '/news' in request.path %}class="active"{% endif %}>Tin tức</a></li>
        <li><a href="/matches"    {% if '/matches' in request.path %}class="active"{% endif %}>Matches</a></li>
        <li><a href="/table"      {% if '/table' in request.path %}class="active"{% endif %}>Table</a></li>
        <li id="nav-bracket" style="display:none"><a href="/bracket" {% if '/bracket' in request.path %}class="active"{% endif %}>Bracket</a></li>
        <li><a href="/statistics" {% if '/statistics' in request.path %}class="active"{% endif %}>Stats</a></li>
        <li><a href="/players"    {% if '/players' in request.path %}class="active"{% endif %}>Players</a></li>
        <li><a href="/clubs"      {% if '/clubs' in request.path %}class="active"{% endif %}>Clubs</a></li>
      </ul>

      <div class="league-toggle" role="group" aria-label="League selector" style="margin-left:20px">
        <button class="league-toggle-btn active"
                data-league-toggle="PL"
                aria-pressed="true"
                title="Premier League"
                style="display:flex; align-items:center; justify-content:center;">
          <img src="/static/images/pl-logo.png" alt="Premier League" width="22" height="22" style="object-fit:contain;">
        </button>
        <button class="league-toggle-btn"
                data-league-toggle="UCL"
                aria-pressed="false"
                title="UEFA Champions League"
                style="display:flex; align-items:center; justify-content:center;">
          <img src="/static/images/ucl-logo.png" alt="Champions League" width="22" height="22" style="object-fit:contain;">
        </button>
      </div>
    </nav>

    <div class="header-right" style="display:flex; align-items:center;">
      <button class="header-search-btn" data-search-open aria-label="Tìm kiếm">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
          <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
        </svg>
      </button>

      <div class="auth-logged-out flex gap-sm" style="display:flex; align-items:center;">
        <a href="/login"    class="btn-header-login" style="display:flex; align-items:center; justify-content:center; box-sizing:border-box; line-height:1;">Đăng nhập</a>
        <a href="/register" class="btn-header-register" style="display:flex; align-items:center; justify-content:center; box-sizing:border-box; line-height:1;">Đăng ký</a>
      </div>

      <div class="auth-logged-in hidden flex gap-sm" style="display:flex; align-items:center;">
        <a href="/profile" style="display:flex;align-items:center;gap:8px;color:white">
          <div style="width:32px;height:32px;border-radius:50%;background:var(--color-surface-3);border:2px solid var(--color-accent);display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:900;color:var(--color-accent);transition:all .3s;position:relative;overflow:hidden; box-sizing:border-box;">
            <img data-user-avatar src="" alt="" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;display:none;z-index:1;">
            <span data-user-name style="font-size:12px; line-height:1; display:flex; align-items:center; justify-content:center; width:100%; height:100%; z-index:0; margin:0; padding:0;">U</span>
          </div>
        </a>
        <button onclick="Auth.logout()" class="btn-header-login" style="font-size:.75rem; display:flex; align-items:center; justify-content:center; box-sizing:border-box; line-height:1;">Logout</button>
      </div>

      <button class="header-hamburger" aria-label="Menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
    </div>

  </div>
</header>

<div id="search-overlay" class="search-overlay" role="dialog" aria-label="Tìm kiếm" aria-modal="true">
  <div class="search-overlay-inner">
    <input type="text"
           class="search-overlay-input"
           placeholder="Tìm kiếm tin tức, cầu thủ, CLB..."
           autocomplete="off"
           spellcheck="false">
    <div class="search-results"></div>
    <p style="margin-top:16px;font-size:0.78rem;color:var(--color-text-dim);text-align:center">
      Nhấn <kbd style="background:var(--color-surface-2);padding:2px 7px;border-radius:4px;border:1px solid var(--color-border-strong)">Esc</kbd> để đóng
      &nbsp;·&nbsp;
      <kbd style="background:var(--color-surface-2);padding:2px 7px;border-radius:4px;border:1px solid var(--color-border-strong)">Ctrl+K</kbd> để mở
    </p>
  </div>
  <button class="search-overlay-close" aria-label="Đóng tìm kiếm">✕</button>
</div>

<main class="page-wrapper" id="main-content">
  {% block content %}{% endblock %}
</main>

<footer class="site-footer" role="contentinfo">
  <div class="container">
    <div class="footer-inner">

      <div class="footer-brand">
        <div class="footer-logo">
          <div class="footer-logo-mark" style="background:transparent; padding:0;">
             <img src="/static/images/logo.png" alt="AimondNews Logo" style="width:100%; height:100%; object-fit:contain;" onerror="this.src='/static/images/logo.svg'">
          </div>
          <span class="footer-logo-text">AimondNews</span>
        </div>
        <p class="footer-tagline">
          Tin tức và số liệu bóng đá chính xác tuyệt đối.
          Tập trung vào Premier League & UEFA Champions League mùa giải 2025/26.
        </p>
      </div>

      <div>
        <p class="footer-col-title">Giải đấu</p>
        <ul class="footer-links">
          <li><a href="/table?league=PL">Bảng XH Premier League</a></li>
          <li><a href="/table?league=UCL">Bảng XH Champions League</a></li>
          <li><a href="/matches?league=PL">Lịch PL</a></li>
          <li><a href="/matches?league=UCL">Lịch UCL</a></li>
          <li><a href="/statistics">Thống kê</a></li>
        </ul>
      </div>

      <div>
        <p class="footer-col-title">Khám phá</p>
        <ul class="footer-links">
          <li><a href="/players">Cầu thủ</a></li>
          <li><a href="/clubs">Câu lạc bộ</a></li>
          <li><a href="/">Tin tức mới nhất</a></li>
          <li><a href="/statistics?sort=goals">Vua phá lưới</a></li>
          <li><a href="/statistics?sort=assists">Kiến tạo</a></li>
        </ul>
      </div>

      <div>
        <p class="footer-col-title">Tài khoản</p>
        <ul class="footer-links">
          <li><a href="/login">Đăng nhập</a></li>
          <li><a href="/register">Đăng ký</a></li>
          <li><a href="/profile">Hồ sơ</a></li>
        </ul>
        <p class="footer-col-title" style="margin-top:24px">Trợ lý AI</p>
        <p style="font-size:.82rem;color:var(--color-text-muted)">
          Hỏi AAA — AimondAI Assistant<br>về bất kỳ điều gì liên quan đến bóng đá.
        </p>
      </div>

    </div>

    <div class="footer-bottom">
      <span>© 2025 AimondNews.com — Dữ liệu cập nhật real-time từ premierleague.com & uefa.com</span>
      <span>Mùa giải <span data-league-season>2025/26</span> &nbsp;·&nbsp; <span data-league-label>Premier League</span></span>
    </div>
  </div>
</footer>

{% include 'partials/chatbot.html' %}

<script src="{{ url_for('static', filename='js/theme.js') }}"></script>
<script src="{{ url_for('static', filename='js/api.js') }}"></script>
<script src="{{ url_for('static', filename='js/ui.js') }}"></script>
<script src="{{ url_for('static', filename='js/auth.js') }}"></script>
<script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    Auth.init();

    Theme.onChange((league) => {
      if (window.location.pathname !== '/') {
        window.location.href = '/';
      } else {
        if (typeof PageData !== 'undefined' && typeof PageData.reload === 'function') {
          PageData.reload(league);
        } else {
          window.location.reload();
        }
      }
    });

    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.target.hasAttribute('data-user-name')) {
          let text = mutation.target.textContent.trim();
          if (text.length > 2) {
            mutation.target.textContent = text.split(/\s+/).map(w => w[0]).join('').substring(0, 2).toUpperCase();
          }
        }
      });
    });
    document.querySelectorAll('[data-user-name]').forEach(el => observer.observe(el, { childList: true, characterData: true }));
  });
</script>

{% block extra_js %}{% endblock %}
<script>
(function(){
  function updateBracketNav(lg) {
    const el = document.getElementById("nav-bracket");
    if (el) el.style.display = (lg||"PL").toUpperCase() === "UCL" ? "" : "none";
  }
  document.addEventListener("DOMContentLoaded", () => {
    if (typeof Theme !== "undefined") {
      updateBracketNav(Theme.getLeague());
      Theme.onChange(updateBracketNav);
    }
  });
})();
</script>
</body>
</html>